# 🔒 FANZA同人出版用モザイクツール

FANZA同人に出版する画像を、FANZA隠蔽処理規約第6条に準拠してモザイクを自動でかけるツールです。

## ✨ 特徴

- **完全自動化**: 性器検出からモザイク処理まで全自動実行
- **FANZA規約準拠**: 第6条の隠蔽処理規約に完全準拠
- **アニメ/イラスト特化**: アニメ系画像での高精度検出
- **ワンクリック実行**: 画像配置のみで処理開始
- **高速処理**: 1枚あたり5秒以内での完了

## 🚀 セットアップ

### 1. 依存関係のインストール

```bash
pip install -r requirements.txt
```

### 2. フォルダ構造の確認

```
mozaic/
├── input/          # 元画像格納フォルダ
├── output/         # 処理成功画像保存フォルダ
├── error/          # 処理失敗画像保存フォルダ
├── app.py          # メインアプリケーション
├── mosaic_processor.py  # モザイク処理エンジン
└── requirements.txt      # 依存関係定義
```

## 📖 使用方法

### 1. 画像の配置
`input/`フォルダにモザイクをかけたい画像を配置してください。

**対応形式**: PNG, JPG, JPEG

### 2. アプリケーションの起動

```bash
streamlit run app.py
```

### 3. 処理の実行
1. ブラウザでアプリケーションにアクセス
2. 「処理開始」ボタンをクリック
3. 処理完了後、結果を確認

### 4. 結果の確認
- **成功**: `output/`フォルダに処理済み画像が保存
- **失敗**: `error/`フォルダに元画像が移動

## 🔧 FANZA規約対応

### 規約第6条の実装

- **（1）モザイクサイズ**: 画像長辺×1/100の自動計算
- **（2）視覚的不明瞭**: ピクセル化による細部の不明瞭化
- **（3）技術的不可逆**: 元の表現に戻せない処理
- **（4）範囲指定**: 輪郭線を含む完全隠蔽
- **（5）必要部位**: 検出された全性器領域への処理
- **（6）処理の完全性**: 必要な部分への全体的な隠蔽

### モザイク処理仕様

- **基本サイズ**: 最小4ピクセル平方
- **動的サイズ**: 画像長辺400px以上で長辺×1/100
- **処理方法**: ピクセル化 + 境界線ぼかし
- **適用範囲**: 検出された性器領域全体

## 🌐 Streamlit Cloud でのデプロイ

### 1. GitHubリポジトリの準備
```bash
git init
git add .
git commit -m "Initial commit"
git remote add origin <your-github-repo-url>
git push -u origin main
```

### 2. Streamlit Cloudでの設定
1. [Streamlit Cloud](https://streamlit.io/cloud)にアクセス
2. GitHubアカウントでログイン
3. 「New app」をクリック
4. リポジトリとブランチを選択
5. メインファイルパスに`app.py`を指定
6. デプロイ実行

### 3. 共有方法
生成されたURL（例：`https://your-app-name.streamlit.app`）を共有するだけです。

## ⚠️ 注意事項

- 処理に失敗した画像は`error/`フォルダに移動されます
- 元画像は処理完了後に削除されます
- 高解像度画像は処理時間が長くなる場合があります
- アニメ/イラスト系の画像に最適化されています

## 🐛 トラブルシューティング

### よくある問題

1. **性器領域が検出されない**
   - 画像の解像度を確認
   - 人体が明確に描かれているか確認

2. **処理が遅い**
   - 画像サイズを確認
   - 同時処理数を減らす

3. **エラーが発生する**
   - ログを確認
   - 画像形式が対応しているか確認

## 📝 技術仕様

### 使用技術
- **Python 3.8+**
- **MediaPipe**: Google提供の人体検出ライブラリ
- **OpenCV**: 高速画像処理ライブラリ
- **Streamlit**: Web UIフレームワーク

### 処理フロー
1. 画像読み込み・前処理
2. MediaPipeによる人体・性器検出
3. 検出領域の自動特定
4. FANZA規約準拠のピクセル化モザイク
5. 境界線のぼかし処理
6. 結果判定・適切なフォルダへの振り分け

## 🤝 貢献

バグ報告や機能要望は、GitHubのIssueでお知らせください。

## 📄 ライセンス

このプロジェクトはMITライセンスの下で公開されています。

---

**作成日**: 2024年12月  
**バージョン**: 1.0  
**作成者**: AI Assistant
